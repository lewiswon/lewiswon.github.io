<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta
    http-equiv="X-UA-Compatible"
    content="IE=edge"
  >
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1"
  >
  <meta
    name="description"
    content="皆是胡言"
  >
  <title>皆是胡言</title>
  <link
    href="/css/normalize.css"
    rel="stylesheet"
  >
  <link
    href="/css/blog.css"
    rel="stylesheet"
  >
  <link
    rel="stylesheet"
    href="//unpkg.com/heti/umd/heti.min.css"
  >
  <link
    rel="apple-touch-icon"
    sizes="180x180"
    href="/apple-touch-icon.png"
  >
  <link
    rel="icon"
    type="image/png"
    sizes="32x32"
    href="/favicon-32x32.png"
  >
  <link
    rel="icon"
    type="image/png"
    sizes="16x16"
    href="/favicon-16x16.png"
  >
  <link
    rel="manifest"
    href="/site.webmanifest"
  >
  <link
    rel="mask-icon"
    href="/safari-pinned-tab.svg"
    color="#5bbad5"
  >
  <meta
    name="msapplication-TileColor"
    content="#da532c"
  >
  <meta
    name="theme-color"
    content="#ffffff"
  >
  <style>
    html {
      font-family: Arial, Helvetica, sans-serif;
    }

    a {
      text-decoration: none;
    }

    a:visited {
      color: #000;
    }

    a:hover {
      text-decoration: none;
    }

    .logo {
      font-family: Arial, Helvetica, sans-serif
    }
  </style>

</head>
<body>
  <div>
  </div>
  <div style="max-width: 45em;margin: 0 auto;">
    <div style="padding-top: 1rem;padding-left: .8rem; padding-right: .8rem;">
      <section class="section">
        <div class="container">
          
          <div style="border: solid 1px #e7e7e7;padding-left: 2rem;padding-top: 2rem;padding-right: 2rem;">
            <div class="entry heti">
              <h1 style="margin-bottom: 0px;">
                PVE的一些命令
              </h1>
              <div style="color: darkgray;">2022-08-18</div>
              <div style="height: 2px;background-color: #ccc;margin-bottom: 2rem;margin-top: 1rem;"></div>
              <div>
              </div>
              <h2 id="0x00-qian-yan">0x00 前言</h2>
<p>在N5105的软路由上装了 <code>Proxmox PVE</code> 来管理整个环境，顺便装了 Homeassistant，但是不明原因的连续两次出现虚拟机死掉，从 PVE 的 WebUI 上操作各种超时和失败，Google 了一下，发现可以进入 PVE 的 Shell 进行操作，所以就在这里记录一些相关的操作，以免后面再次遇到。</p>
<h2 id="0x01-zhi-jie-sha-si-xu-ni-ji-de-jin-cheng">0x01 直接杀死虚拟机的进程</h2>
<p>找到虚拟机的PID</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># VIMID为虚拟机的ID,在 PVE 的 WebUI 上可以看到
</span><span style="color:#bf616a;">ps</span><span> aux | </span><span style="color:#bf616a;">grep </span><span>&#39;</span><span style="color:#a3be8c;">/usr/bin/kvm -id VMID</span><span>&#39;
</span></code></pre>
<p>杀死虚拟机的进程</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#96b5b4;">kill</span><span> -9 PID
</span></code></pre>
<p>杀死了锁定他的进程后，就可以使用 qemu 的命令，对虚拟机进行停止了。</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>qm stop VMID
</span></code></pre>

            </div>
            <div style="text-align: center;color:#ccc;margin: 2rem 0;"> — EOF — </div>
            <div style="height: 1rem;"></div>
          </div>
          <div style="height: 4rem;"></div>
          <script
            src="https://giscus.app/client.js"
            data-repo="lewiswon/giscus"
            data-repo-id="R_kgDOGqla5g"
            data-category="Announcements"
            data-category-id="DIC_kwDOGqla5s4CApzV"
            data-mapping="pathname"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-theme="light"
            data-lang="zh-CN"
            crossorigin="anonymous"
            async
          >
          </script>
          <div style="height: 4rem;"></div>
          
        </div>
      </section>
    </div>
</body>

</html>